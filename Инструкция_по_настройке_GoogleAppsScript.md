# Инструкция по настройке Google Apps Script для проекта "Интерактивная схема зданий"

## Подготовка Google Таблицы

1. Откройте Excel файл "Реестр объектов недвижимости.xlsx"
2. Создайте новую Google Таблицу на https://sheets.google.com
3. Импортируйте данные из Excel файла:
   - В Google Таблице выберите **Файл > Импорт**
   - Загрузите файл Excel или перетащите его в окно импорта
   - Выберите опцию "Заменить текущий лист"
   - Нажмите "Импорт данных"
4. Убедитесь, что в первой строке таблицы есть следующие заголовки:
   - "Номер помещения"
   - "Арендатор"
   - "Договор"
   - "Арендная плата"
5. При необходимости отредактируйте заголовки, чтобы они соответствовали требуемым

## Настройка Google Apps Script

1. Откройте вашу Google Таблицу
2. Выберите **Расширения > Apps Script**
3. В открывшемся редакторе скриптов удалите весь код по умолчанию
4. Скопируйте и вставьте код из файла "google-apps-script.js"
5. Найдите строку `const spreadsheetId = 'ID_ВАШЕЙ_ТАБЛИЦЫ';`
6. Замените `ID_ВАШЕЙ_ТАБЛИЦЫ` на ID вашей Google Таблицы:
   - ID находится в URL таблицы между `/d/` и `/edit`
   - Например, для URL `https://docs.google.com/spreadsheets/d/1a2b3c4d5e6f7g8h9i0j/edit` ID будет `1a2b3c4d5e6f7g8h9i0j`
7. Сохраните скрипт (**Файл > Сохранить** или Ctrl+S)

## Тестирование скрипта

1. В редакторе Apps Script выберите функцию `test` в выпадающем меню рядом с кнопкой "Выполнить"
2. Нажмите кнопку "Выполнить" (иконка воспроизведения)
3. При первом запуске вам будет предложено авторизовать скрипт:
   - Нажмите "Проверка"
   - Войдите в свой аккаунт Google, если потребуется
   - Нажмите "Дополнительно" и затем "Перейти к [название проекта] (небезопасно)"
   - Нажмите "Разрешить"
4. После успешного выполнения скрипта откройте журнал выполнения (**Вид > Журнал выполнения**) и проверьте, что данные корректно считываются из таблицы

## Публикация веб-приложения

1. В редакторе Apps Script нажмите кнопку "Развертывание" в правом верхнем углу
2. Выберите "Новое развертывание"
3. Нажмите на значок шестеренки рядом с "Выберите тип"
4. Выберите "Веб-приложение"
5. Заполните следующие поля:
   - **Описание:** Интерактивная схема зданий API
   - **Выполнить как:** Я (ваш email)
   - **Кто имеет доступ:** Все, даже анонимные
6. Нажмите "Развернуть"
7. Скопируйте URL веб-приложения, который будет показан после развертывания

## Интеграция с веб-приложением

1. Откройте файл "script.js" в вашем проекте
2. Найдите строку: `const API_URL = '';`
3. Вставьте скопированный URL веб-приложения в кавычки:
   ```javascript
   const API_URL = 'https://script.google.com/macros/s/ваш-длинный-идентификатор/exec';
   ```
4. Сохраните файл

## Обновление развернутого приложения

Если вы внесете изменения в Google Apps Script и захотите обновить развернутое приложение:

1. Сохраните внесенные изменения
2. Нажмите "Развертывание" > "Управление развертываниями"
3. Найдите ваше развертывание и нажмите на значок редактирования (карандаш)
4. Выберите "Новая версия"
5. Нажмите "Развернуть"
6. URL веб-приложения останется прежним

## Встраивание Google Таблицы на страницу

1. Откройте вашу Google Таблицу
2. Выберите **Файл > Опубликовать в Интернете**
3. Выберите нужный лист и формат "Веб-страница"
4. Нажмите "Опубликовать"
5. Скопируйте iframe код или создайте его в следующем формате:
   ```html
   <iframe src="https://docs.google.com/spreadsheets/d/ваш-id-таблицы/pubhtml?widget=true&amp;headers=false" 
     width="100%" height="400" frameborder="0"></iframe>
   ```
6. Вставьте этот код в `<div class="iframe-container">` в файле index.html вместо текста-заполнителя 